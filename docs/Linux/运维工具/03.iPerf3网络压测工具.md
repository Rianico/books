---
title: iPerf3网络压测工具
date: 2021-03-03

---

# iPerf3网络压测工具

## 1. 介绍

iPerf3 是一个可以用于网络带宽测试的工具，支持多种参数设置，如时间、buffer、网络协议（TCP，UDP 等）。

## 2. 下载

在该页面选择适合自己系统的二进制包：https://iperf.fr/iperf-download.php#archlinux 。

Linux 下载下来后是一个 xz 压缩包，解压命令如下：

```bash
tar -Jxvf iperf3-3.1.3-1-x86_64.pkg.tar.xz
```

或者通过 yum 安装：

```bash
yum -y install iPerf3
```

## 3. 使用

iPerf3 的运行方式为 server-client 模式，起两个进程，一端为 server，一端为 client，两边进行传输，从而测试出网络带宽。

假设一台机器 host 为 server.local，启动一个服务端：

```bash
iperf3 -s -D -p 5201 -f M
```

各参数解释如下：

- -s：以 server 模式运行
- -D：以守护进程方式运行
- -p：指定监听的的端口，默认 5201
- -f：指定速率的输出格式，有 `kmKM` 四种可选，大小写的区别为 Byte 以及 bit

接下来启动一个客户端：

```bash
iperf3 -c server.local -f m -P 1 -Z -4
```

各参数解释如下：

- -c：以客户端模式运行，并指定服务端的 host
- -f：指定速率的输出格式，有 `kmKM` 四种可选，大小写的区别为 Byte 以及 bit
- -P：指定并发的线程数，默认 1
- -4：使用 iPv4
- -Z：零拷贝模式，实测中零拷贝使用多线程会有线程切换的开销，反而导致速率降低

更详细的设置参数可以查看[官方文档](https://iperf.fr/iperf-doc.php#3doc) 。

在本地启动一个客户端执行上述，结果如下：

```
Connecting to host server.local, port 5201
[  4] local 192.168.1.167 port 44178 connected to 192.168.1.167 port 5201
[ ID] Interval           Transfer     Bandwidth       Retr  Cwnd
[  4]   0.00-1.00   sec  6.16 GBytes  6304 MBytes/sec    0   1.25 MBytes       
...             
[  4]   9.00-10.00  sec  6.56 GBytes  6717 MBytes/sec    0   1.25 MBytes       
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bandwidth       Retr
[  4]   0.00-10.00  sec  65.3 GBytes  6683 MBytes/sec    0             sender
[  4]   0.00-10.00  sec  65.3 GBytes  6682 MBytes/sec                  receiver
```

