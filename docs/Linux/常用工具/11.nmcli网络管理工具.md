---
title: 11. nmcli网络管理工具
date: 2021-05-25
---

## nmcli 网络管理工具

nmcli 是 NetworkManager 的一个命令行工具，它提供了使用命令行配置由 NetworkManager 管理网络连接的方法。使用 nmcli 的好处是即使在系统启动后，路由规则也能保留。

nmcli 命令的基本格式为：

```bash
Usage: nmcli [OPTIONS] OBJECT { COMMAND | help }

OPTIONS
  -a, --ask                                ask for missing parameters
  -c, --colors auto|yes|no                 whether to use colors in output
  -e, --escape yes|no                      escape columns separators in values
  -f, --fields <field,...>|all|common      specify fields to output
  -g, --get-values <field,...>|all|common  shortcut for -m tabular -t -f
  -h, --help                               print this help
  -m, --mode tabular|multiline             output mode
  -o, --overview                           overview mode
  -p, --pretty                             pretty output
  -s, --show-secrets                       allow displaying passwords
  -t, --terse                              terse output
  -v, --version                            show program version
  -w, --wait <seconds>                     set timeout waiting for finishing operations

OBJECT
  g[eneral]       NetworkManager's general status and operations
  n[etworking]    overall networking control
  r[adio]         NetworkManager radio switches
  c[onnection]    NetworkManager's connections
  d[evice]        devices managed by NetworkManager
  a[gent]         NetworkManager secret agent or polkit agent
  m[onitor]       monitor NetworkManager changes
```

1. 启动/关闭网卡：

   ```bash
   nmcli c down enp189s0f0 && nmcli c up enp189s0f0
   ```

2. 添加路由：

   ```bash
   nmcli c modify enp189s0f0 +ipv4.routes "192.167.0.0/16 192.168.0.1"
   ```

3. 设置网卡 IP：

   ```bash
   nmcli c mod enp189s0f0 ipv4.addresses "192.168.1.4/24"
   ```

4. 设置网卡 gateway

   ```bash
   nmcli con mod enp189s0f0 ipv4.gateway "192.168.0.1"
   ```

5. 设置网卡 IP 设置方式为手动（from dhcp to static）：

   ```bash
   nmcli con mod enp189s0f0 ipv4.method manual
   ```

6. 设置网卡 DNS：

   ```bash
   nmcli con mod enp189s0f0 ipv4.dns "8.8.8.8"
   ```

设置完成记得重启相应网卡设备。

