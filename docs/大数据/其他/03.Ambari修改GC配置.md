---
title: 03.Ambari 修改 GC 配置
date: 2021-06-10
---

## Ambari 修改 GC 配置

在网上搜到的关于修改 Ambari GC 配置都是去到 `/var/lib/ambari-server/ambari-env.sh` 下，但这只能追加一些 JVM 配置，如堆内存等，但无法修改 GC 收集器，真正设置了 JVM 配置的地方在一个 python 启动脚本里，路径为：`/usr/sbin/ambari_server_main.py`。

Ambari 默认为 CMS 收集器，找到 `SERVER_START_CMD`，修改为 G1 收集器：

```python
SERVER_START_CMD = "{0} " \
    "-server " \
    "-XX:+UseG1GC -Xms8196m -Xmx8196m " + \
    "-Dsun.zip.disableMemoryMapping=true " + \
    "{1} {2} " \
    "-cp {3} "\
    "org.apache.ambari.server.controller.AmbariServer " \
"> {4} 2>&1 || echo $? > {5}"
```

还有其他几个类似名称的，分别对应 debug 模式、Windows 平台，根据需要修改即可。