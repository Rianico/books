---
title: 06. 门电路
date: 2020-09-01
---

## 1. 门电路

最原始通用的数据传输方式，通常是通过烽火、声音、光等形式，这些方式都只能表示很简单的信息，因此基本可以抽象为 “0” 和 “1” 两种信号。

在出现电报之后，人们可以很方便的通过**门电路**来表示 “0” 和 “1”，电报传输的信号有两种，一种是短促的**点信号**（dot 信号），一种是长一点的**划信号**（dash 信号）。

电报机本质上就是一个“蜂鸣器 + 长长的电线 + 按钮开关”，通电与不通电可以表示 “0” 和 “1” ：

![](https://static001.geekbang.org/resource/image/28/12/283742f3a72eba22f6b4ae97e21c4112.jpg)

当距离一长，电阻也会变大，因此需要一个中间件能够**接力传输**电报信号，即**继电器**（Relay，也称作**电驿**）：

![](https://static001.geekbang.org/resource/image/11/ea/1186a10341202ea36df27cba95f1cbea.jpg)

受益于信号只有两种状态，因此可以**很容易的原样传输信号**。

通过这些线圈和开关，可以很容易地创建出 “与（AND）”、“或（OR）”、“非（NOT）” 的逻辑：

- 在输入端的电路上，提供串联的两个开关，只有两个开关都打开，输出的开关也才能接通，模拟了计算机里面的 “与” 操作。
- 在输入端的电路上，提供并联的两个开关，只要有其中一个开关打开，输出的开关就能接通，模拟了计算机里面的 “或” 操作。
- 提供两个开关，输出端的开关默认打开，在输入端的电路上接通开关的时候，输出端开关会因为磁场而关闭，输出端开和关正好和输入端相反。这个在数字电路中，也叫作**反向器**（Inverter）。

![](https://static001.geekbang.org/resource/image/97/5e/977b09f3a334304c2861c6b420217b5e.jpg)

与、或、非的电路都非常简单，并借助这些简单的门电路，组合出复杂的功能，这也体现了现代计算机体系中一个重要的思想：**通过分层和组合，逐步搭建起更加强大的功能**。

电报是现代计算机的一个最简单的原型，一方面，我们可以通过继电器或者中继，进行长距离的信号传输。另一方面，通过设置不同的线路和开关状态，实现更多不同的信号表示和处理方式。

门电路也是创建 CPU 和内存的基本逻辑单元。各种对于计算机二进制的“0”和“1”的操作，本质就是操作门电路，称为**组合逻辑电路**。

---

## 2. 加法器

加法器是通过几个简单的门电路组成的，各个门电路标识如下：

![](https://static001.geekbang.org/resource/image/94/f6/94194480bcfd3b5366e4649ee80de4f6.jpg)

二进制加法各场景如下：

![](https://static001.geekbang.org/resource/image/18/d1/1854b98fcac2c6bf4949ac5e2247d9d1.jpg)

可以看到，求进位其实就是做**与门（AND）**，求和则是做**异或门（XOR）**，也就是说一个加法用到了两个门电路，我们将这两个门电路打包成一个**半加器（Half Adder）**：

![](https://static001.geekbang.org/resource/image/58/1e/5860fd8c4ace079b40e66b9568d2b81e.jpg)

全加器是由**两个半加器** + **一个或门**组成的：

![](https://static001.geekbang.org/resource/image/3f/2a/3f11f278ba8f24209a56fb3ee1ca9e2a.jpg)

全加器可用于做加法运算，比如两个数相加，在二位上先对加数与被加数使用半加器进行计算，得到进位标志 **X** 以及和 **Y**，接着 **Y** 与前一位的进位信号信号在经过半加器，得到最终的和 **W** 以及一个进位信号，再将该进位信号与 **X** 经过或门得出最终的进位信号 **V**，后面的计算则如此反复。

有了全加器，一旦我们需要对两个 8 bit 的数求和，则串联 8 个全加器即可：

![](https://static001.geekbang.org/resource/image/68/a1/68cd38910f526c149d232720b82b6ca1.jpeg)

需要注意的是，个位只需要一个半加器即可。

> NOTE：实际上，也可以让个位的全加器的进位信号为 0 ，进位信号则表示当前位是否发生溢出，并可以将最后一位的进位信号，输出到硬件中，能够让计算机直到是否发生溢出，现代计算机也是这么做的。

硬件层面，通过门电路 -> 半加器 -> 全加器 一层层搭出了加法器这样的功能组件，这类用来做算术逻辑计算的组件叫作 ALU，也就是算术逻辑单元。