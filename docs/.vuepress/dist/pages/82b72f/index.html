<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>05-dui-lie | zxk&#39;s book</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="/books/Avatar.jpg">
    <meta name="description" content="兴趣使然的备忘库">
    <link rel="preload" href="/books/assets/css/0.styles.2bff962d.css" as="style"><link rel="preload" href="/books/assets/js/app.f9151f91.js" as="script"><link rel="preload" href="/books/assets/js/2.5d2686d5.js" as="script"><link rel="preload" href="/books/assets/js/56.5c06941f.js" as="script"><link rel="prefetch" href="/books/assets/js/10.f2f9b742.js"><link rel="prefetch" href="/books/assets/js/100.6b9e14d2.js"><link rel="prefetch" href="/books/assets/js/101.809c333a.js"><link rel="prefetch" href="/books/assets/js/102.07dacb70.js"><link rel="prefetch" href="/books/assets/js/103.82a790ad.js"><link rel="prefetch" href="/books/assets/js/104.e0568e90.js"><link rel="prefetch" href="/books/assets/js/105.31bdf646.js"><link rel="prefetch" href="/books/assets/js/106.bdee5f25.js"><link rel="prefetch" href="/books/assets/js/107.18b4d846.js"><link rel="prefetch" href="/books/assets/js/108.c7f4b781.js"><link rel="prefetch" href="/books/assets/js/109.e162c870.js"><link rel="prefetch" href="/books/assets/js/11.eaeab904.js"><link rel="prefetch" href="/books/assets/js/110.12faedac.js"><link rel="prefetch" href="/books/assets/js/111.6511b4c1.js"><link rel="prefetch" href="/books/assets/js/112.904e9119.js"><link rel="prefetch" href="/books/assets/js/113.a472c3d2.js"><link rel="prefetch" href="/books/assets/js/12.fddb2c97.js"><link rel="prefetch" href="/books/assets/js/13.5bc2badc.js"><link rel="prefetch" href="/books/assets/js/14.b4364281.js"><link rel="prefetch" href="/books/assets/js/15.079b350f.js"><link rel="prefetch" href="/books/assets/js/16.32ceddec.js"><link rel="prefetch" href="/books/assets/js/17.ef4b2635.js"><link rel="prefetch" href="/books/assets/js/18.08f0107e.js"><link rel="prefetch" href="/books/assets/js/19.eaf9b482.js"><link rel="prefetch" href="/books/assets/js/20.1b9e5f90.js"><link rel="prefetch" href="/books/assets/js/21.26fba91c.js"><link rel="prefetch" href="/books/assets/js/22.ad47033d.js"><link rel="prefetch" href="/books/assets/js/23.b5c9bae3.js"><link rel="prefetch" href="/books/assets/js/24.a3413f8c.js"><link rel="prefetch" href="/books/assets/js/25.e83b9eb2.js"><link rel="prefetch" href="/books/assets/js/26.b57ca478.js"><link rel="prefetch" href="/books/assets/js/27.e5299aa1.js"><link rel="prefetch" href="/books/assets/js/28.a8237bd6.js"><link rel="prefetch" href="/books/assets/js/29.f864591a.js"><link rel="prefetch" href="/books/assets/js/3.3d5ed5b9.js"><link rel="prefetch" href="/books/assets/js/30.09c7f951.js"><link rel="prefetch" href="/books/assets/js/31.a3b1ad43.js"><link rel="prefetch" href="/books/assets/js/32.42bb8a78.js"><link rel="prefetch" href="/books/assets/js/33.55ba559d.js"><link rel="prefetch" href="/books/assets/js/34.84a76cd1.js"><link rel="prefetch" href="/books/assets/js/35.2eb759c6.js"><link rel="prefetch" href="/books/assets/js/36.d87c909a.js"><link rel="prefetch" href="/books/assets/js/37.676b1811.js"><link rel="prefetch" href="/books/assets/js/38.8f7d1a0c.js"><link rel="prefetch" href="/books/assets/js/39.a9c6f365.js"><link rel="prefetch" href="/books/assets/js/4.e8102eb5.js"><link rel="prefetch" href="/books/assets/js/40.dfc0be78.js"><link rel="prefetch" href="/books/assets/js/41.220cd735.js"><link rel="prefetch" href="/books/assets/js/42.d1d8b76d.js"><link rel="prefetch" href="/books/assets/js/43.c89fa3d4.js"><link rel="prefetch" href="/books/assets/js/44.4d0d2eac.js"><link rel="prefetch" href="/books/assets/js/45.217bc0d6.js"><link rel="prefetch" href="/books/assets/js/46.9e209fe4.js"><link rel="prefetch" href="/books/assets/js/47.6cafdd03.js"><link rel="prefetch" href="/books/assets/js/48.1ed1152d.js"><link rel="prefetch" href="/books/assets/js/49.1dfa167c.js"><link rel="prefetch" href="/books/assets/js/5.57058efb.js"><link rel="prefetch" href="/books/assets/js/50.67247263.js"><link rel="prefetch" href="/books/assets/js/51.f3f44eac.js"><link rel="prefetch" href="/books/assets/js/52.dee96030.js"><link rel="prefetch" href="/books/assets/js/53.8de5e5da.js"><link rel="prefetch" href="/books/assets/js/54.c29e9824.js"><link rel="prefetch" href="/books/assets/js/55.63e78072.js"><link rel="prefetch" href="/books/assets/js/57.b7a5455e.js"><link rel="prefetch" href="/books/assets/js/58.399bfd87.js"><link rel="prefetch" href="/books/assets/js/59.e8ba8726.js"><link rel="prefetch" href="/books/assets/js/6.c21fcf0a.js"><link rel="prefetch" href="/books/assets/js/60.02c5e9e4.js"><link rel="prefetch" href="/books/assets/js/61.d7a8dff4.js"><link rel="prefetch" href="/books/assets/js/62.9fbe6b12.js"><link rel="prefetch" href="/books/assets/js/63.f4144691.js"><link rel="prefetch" href="/books/assets/js/64.625a5997.js"><link rel="prefetch" href="/books/assets/js/65.f151fcc6.js"><link rel="prefetch" href="/books/assets/js/66.5dd49279.js"><link rel="prefetch" href="/books/assets/js/67.b261a8bb.js"><link rel="prefetch" href="/books/assets/js/68.5c0db65d.js"><link rel="prefetch" href="/books/assets/js/69.f29b8f9d.js"><link rel="prefetch" href="/books/assets/js/7.29e49b4b.js"><link rel="prefetch" href="/books/assets/js/70.209f4eea.js"><link rel="prefetch" href="/books/assets/js/71.22af6d4e.js"><link rel="prefetch" href="/books/assets/js/72.873c578d.js"><link rel="prefetch" href="/books/assets/js/73.582c4c19.js"><link rel="prefetch" href="/books/assets/js/74.2e9b50a7.js"><link rel="prefetch" href="/books/assets/js/75.cb1c78b7.js"><link rel="prefetch" href="/books/assets/js/76.571a1206.js"><link rel="prefetch" href="/books/assets/js/77.ae6dfb32.js"><link rel="prefetch" href="/books/assets/js/78.99676d8d.js"><link rel="prefetch" href="/books/assets/js/79.a69c427f.js"><link rel="prefetch" href="/books/assets/js/8.6baa7a2a.js"><link rel="prefetch" href="/books/assets/js/80.360e369a.js"><link rel="prefetch" href="/books/assets/js/81.a726b870.js"><link rel="prefetch" href="/books/assets/js/82.f8c4b75c.js"><link rel="prefetch" href="/books/assets/js/83.883eda30.js"><link rel="prefetch" href="/books/assets/js/84.12b612f0.js"><link rel="prefetch" href="/books/assets/js/85.7d06897a.js"><link rel="prefetch" href="/books/assets/js/86.fef0a5ab.js"><link rel="prefetch" href="/books/assets/js/87.81793334.js"><link rel="prefetch" href="/books/assets/js/88.c83371a7.js"><link rel="prefetch" href="/books/assets/js/89.ba300068.js"><link rel="prefetch" href="/books/assets/js/9.0a57bc79.js"><link rel="prefetch" href="/books/assets/js/90.28dd693b.js"><link rel="prefetch" href="/books/assets/js/91.b003bc4b.js"><link rel="prefetch" href="/books/assets/js/92.f5f082b1.js"><link rel="prefetch" href="/books/assets/js/93.64814564.js"><link rel="prefetch" href="/books/assets/js/94.711d6b38.js"><link rel="prefetch" href="/books/assets/js/95.84a10586.js"><link rel="prefetch" href="/books/assets/js/96.28278f73.js"><link rel="prefetch" href="/books/assets/js/97.a67549d9.js"><link rel="prefetch" href="/books/assets/js/98.11356857.js"><link rel="prefetch" href="/books/assets/js/99.c056a3dc.js">
    <link rel="stylesheet" href="/books/assets/css/0.styles.2bff962d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/books/" class="router-link-active home-link"><img src="/books/Avatar.jpg" alt="zxk's book" class="logo"> <span class="site-name">zxk's book</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          大数据
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/books/" class="router-link-active">
          Home
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <a href="https://github.com/Rianico/books" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>01.数据结构与算法（专栏学习）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/books/算法/01.数据结构与算法（专栏学习）/01-shi-jian-fu-za-du.html" title="01-时间复杂度" class="sidebar-link">01-时间复杂度</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/算法/01.数据结构与算法（专栏学习）/01-shi-jian-fu-za-du.html#为什么需要复杂度分析？" title="为什么需要复杂度分析？" class="sidebar-link">为什么需要复杂度分析？</a></li><li class="sidebar-sub-header"><a href="/books/算法/01.数据结构与算法（专栏学习）/01-shi-jian-fu-za-du.html#大-o-复杂度表示法" title="大 O 复杂度表示法" class="sidebar-link">大 O 复杂度表示法</a></li><li class="sidebar-sub-header"><a href="/books/算法/01.数据结构与算法（专栏学习）/01-shi-jian-fu-za-du.html#时间复杂度分析" title="时间复杂度分析" class="sidebar-link">时间复杂度分析</a></li><li class="sidebar-sub-header"><a href="/books/算法/01.数据结构与算法（专栏学习）/01-shi-jian-fu-za-du.html#几种常见的时间复杂度" title="几种常见的时间复杂度" class="sidebar-link">几种常见的时间复杂度</a></li><li class="sidebar-sub-header"><a href="/books/算法/01.数据结构与算法（专栏学习）/01-shi-jian-fu-za-du.html#空间复杂度分析" title="空间复杂度分析" class="sidebar-link">空间复杂度分析</a></li><li class="sidebar-sub-header"><a href="/books/算法/01.数据结构与算法（专栏学习）/01-shi-jian-fu-za-du.html#时间复杂度进阶" title="时间复杂度进阶" class="sidebar-link">时间复杂度进阶</a></li><li class="sidebar-sub-header"><a href="/books/算法/01.数据结构与算法（专栏学习）/01-shi-jian-fu-za-du.html#总结" title="总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/books/pages/5c5c08/" title="02-shu-zu" class="sidebar-link">02-shu-zu</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/5c5c08/#如何实现随机访问？" title="如何实现随机访问？" class="sidebar-link">如何实现随机访问？</a></li><li class="sidebar-sub-header"><a href="/books/pages/5c5c08/#低效的-插入-和-删除" title="低效的“插入”和“删除”" class="sidebar-link">低效的“插入”和“删除”</a></li><li class="sidebar-sub-header"><a href="/books/pages/5c5c08/#警惕数组的访问越界问题" title="警惕数组的访问越界问题" class="sidebar-link">警惕数组的访问越界问题</a></li><li class="sidebar-sub-header"><a href="/books/pages/5c5c08/#容器能否完全替代数组？" title="容器能否完全替代数组？" class="sidebar-link">容器能否完全替代数组？</a></li><li class="sidebar-sub-header"><a href="/books/pages/5c5c08/#思考" title="思考" class="sidebar-link">思考</a></li></ul></li><li><a href="/books/pages/6f5a01/" title="03-lian-biao" class="sidebar-link">03-lian-biao</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/6f5a01/#_1-几种链表结构" title="1. 几种链表结构" class="sidebar-link">1. 几种链表结构</a></li><li class="sidebar-sub-header"><a href="/books/pages/6f5a01/#_1-4-链表-vs-数组性能" title="1.4 链表 VS 数组性能" class="sidebar-link">1.4 链表 VS 数组性能</a></li><li class="sidebar-sub-header"><a href="/books/pages/6f5a01/#_2-基于链表实现lru算法" title="2. 基于链表实现LRU算法" class="sidebar-link">2. 基于链表实现LRU算法</a></li><li class="sidebar-sub-header"><a href="/books/pages/6f5a01/#_3-编写链表的几点技巧" title="3. 编写链表的几点技巧" class="sidebar-link">3. 编写链表的几点技巧</a></li><li class="sidebar-sub-header"><a href="/books/pages/6f5a01/#_2-警惕指针丢失和内存泄漏" title="2. 警惕指针丢失和内存泄漏" class="sidebar-link">2. 警惕指针丢失和内存泄漏</a></li><li class="sidebar-sub-header"><a href="/books/pages/6f5a01/#思考" title="思考" class="sidebar-link">思考</a></li></ul></li><li><a href="/books/pages/33f199/" title="04-zhan" class="sidebar-link">04-zhan</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/33f199/#_1-如何实现栈？" title="1. 如何实现栈？" class="sidebar-link">1. 如何实现栈？</a></li><li class="sidebar-sub-header"><a href="/books/pages/33f199/#_1-2-链式栈" title="1.2 链式栈" class="sidebar-link">1.2 链式栈</a></li><li class="sidebar-sub-header"><a href="/books/pages/33f199/#_2-栈在函数调用中的应用" title="2. 栈在函数调用中的应用" class="sidebar-link">2. 栈在函数调用中的应用</a></li><li class="sidebar-sub-header"><a href="/books/pages/33f199/#_3-栈在表达式求值中的应用" title="3. 栈在表达式求值中的应用" class="sidebar-link">3. 栈在表达式求值中的应用</a></li><li class="sidebar-sub-header"><a href="/books/pages/33f199/#_4-总结" title="4. 总结" class="sidebar-link">4. 总结</a></li></ul></li><li><a href="/books/pages/82b72f/" aria-current="page" title="05-dui-lie" class="active sidebar-link">05-dui-lie</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/82b72f/#_1-顺序队列和链式队列" title="1. 顺序队列和链式队列" class="sidebar-link">1. 顺序队列和链式队列</a></li><li class="sidebar-sub-header"><a href="/books/pages/82b72f/#_2-循环队列" title="2. 循环队列" class="sidebar-link">2. 循环队列</a></li><li class="sidebar-sub-header"><a href="/books/pages/82b72f/#_3-阻塞队列和并发队列" title="3. 阻塞队列和并发队列" class="sidebar-link">3. 阻塞队列和并发队列</a></li><li class="sidebar-sub-header"><a href="/books/pages/82b72f/#_4-思考" title="4. 思考" class="sidebar-link">4. 思考</a></li></ul></li><li><a href="/books/pages/5a8205/" title="06-di-gui" class="sidebar-link">06-di-gui</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/5a8205/#_1-递归代码示例" title="1. 递归代码示例" class="sidebar-link">1. 递归代码示例</a></li><li class="sidebar-sub-header"><a href="/books/pages/5a8205/#_2-递归导致堆栈溢出" title="2. 递归导致堆栈溢出" class="sidebar-link">2. 递归导致堆栈溢出</a></li><li class="sidebar-sub-header"><a href="/books/pages/5a8205/#_3-递归要警惕重复计算" title="3. 递归要警惕重复计算" class="sidebar-link">3. 递归要警惕重复计算</a></li><li class="sidebar-sub-header"><a href="/books/pages/5a8205/#_4-思考" title="4. 思考" class="sidebar-link">4. 思考</a></li></ul></li><li><a href="/books/pages/fcbb91/" title="07-pai-xu" class="sidebar-link">07-pai-xu</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/fcbb91/#_1-冒泡、插入、选择排序" title="1. 冒泡、插入、选择排序" class="sidebar-link">1. 冒泡、插入、选择排序</a></li><li class="sidebar-sub-header"><a href="/books/pages/fcbb91/#_2-快速、归并排序" title="2. 快速、归并排序" class="sidebar-link">2. 快速、归并排序</a></li></ul></li><li><a href="/books/pages/4d335f/" title="08-xian-xing-pai-xu" class="sidebar-link">08-xian-xing-pai-xu</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/4d335f/#_1-桶排序（bucket-sort）" title="1. 桶排序（Bucket Sort）" class="sidebar-link">1. 桶排序（Bucket Sort）</a></li><li class="sidebar-sub-header"><a href="/books/pages/4d335f/#_2-计数排序（counting-sort）" title="2. 计数排序（Counting sort）" class="sidebar-link">2. 计数排序（Counting sort）</a></li><li class="sidebar-sub-header"><a href="/books/pages/4d335f/#_3-基数排序（radix-sort）" title="3. 基数排序（Radix sort）" class="sidebar-link">3. 基数排序（Radix sort）</a></li></ul></li><li><a href="/books/pages/81d135/" title="09-pai-xu-you-hua" class="sidebar-link">09-pai-xu-you-hua</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/81d135/#_1-如何优化快速排序" title="1. 如何优化快速排序" class="sidebar-link">1. 如何优化快速排序</a></li><li class="sidebar-sub-header"><a href="/books/pages/81d135/#_2-举例分析排序函数" title="2. 举例分析排序函数" class="sidebar-link">2. 举例分析排序函数</a></li></ul></li><li><a href="/books/pages/9f635b/" title="10-er-fen-cha-zhao" class="sidebar-link">10-er-fen-cha-zhao</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/9f635b/#_1-介绍" title="1. 介绍" class="sidebar-link">1. 介绍</a></li><li class="sidebar-sub-header"><a href="/books/pages/9f635b/#_2-二分查找的局限性" title="2. 二分查找的局限性" class="sidebar-link">2. 二分查找的局限性</a></li><li class="sidebar-sub-header"><a href="/books/pages/9f635b/#_3-二分查找变形" title="3. 二分查找变形" class="sidebar-link">3. 二分查找变形</a></li><li class="sidebar-sub-header"><a href="/books/pages/9f635b/#_4-思考题" title="4. 思考题" class="sidebar-link">4. 思考题</a></li><li class="sidebar-sub-header"><a href="/books/pages/9f635b/#_5-总结" title="5. 总结" class="sidebar-link">5. 总结</a></li></ul></li><li><a href="/books/pages/62cbc8/" title="11-tiao-biao" class="sidebar-link">11-tiao-biao</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/62cbc8/#_1-时间复杂度与空间复杂度" title="1. 时间复杂度与空间复杂度" class="sidebar-link">1. 时间复杂度与空间复杂度</a></li><li class="sidebar-sub-header"><a href="/books/pages/62cbc8/#_2-动态插入与删除" title="2. 动态插入与删除" class="sidebar-link">2. 动态插入与删除</a></li><li class="sidebar-sub-header"><a href="/books/pages/62cbc8/#_3-索引动态更新" title="3. 索引动态更新" class="sidebar-link">3. 索引动态更新</a></li><li class="sidebar-sub-header"><a href="/books/pages/62cbc8/#_4-思考" title="4. 思考" class="sidebar-link">4. 思考</a></li></ul></li><li><a href="/books/pages/046d2a/" title="12-san-lie-biao" class="sidebar-link">12-san-lie-biao</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/046d2a/#_1-散列函数" title="1. 散列函数" class="sidebar-link">1. 散列函数</a></li><li class="sidebar-sub-header"><a href="/books/pages/046d2a/#_2-散列冲突" title="2. 散列冲突" class="sidebar-link">2. 散列冲突</a></li><li class="sidebar-sub-header"><a href="/books/pages/046d2a/#_3-装载因子" title="3. 装载因子" class="sidebar-link">3. 装载因子</a></li><li class="sidebar-sub-header"><a href="/books/pages/046d2a/#_4-散列表存在的问题" title="4. 散列表存在的问题" class="sidebar-link">4. 散列表存在的问题</a></li><li class="sidebar-sub-header"><a href="/books/pages/046d2a/#_5-开放寻址法-vs-链表法" title="5. 开放寻址法 VS 链表法" class="sidebar-link">5. 开放寻址法 VS 链表法</a></li><li class="sidebar-sub-header"><a href="/books/pages/046d2a/#_6-java中hashmap分析" title="6. Java中HashMap分析" class="sidebar-link">6. Java中HashMap分析</a></li><li class="sidebar-sub-header"><a href="/books/pages/046d2a/#_7-散列表＆链表" title="7. 散列表＆链表" class="sidebar-link">7. 散列表＆链表</a></li><li class="sidebar-sub-header"><a href="/books/pages/046d2a/#_8-redis有序集合" title="8. Redis有序集合" class="sidebar-link">8. Redis有序集合</a></li><li class="sidebar-sub-header"><a href="/books/pages/046d2a/#_9-思考" title="9. 思考" class="sidebar-link">9. 思考</a></li></ul></li><li><a href="/books/pages/29a5b1/" title="13-ha-xi-suan-fa" class="sidebar-link">13-ha-xi-suan-fa</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/29a5b1/#_1-安全加密" title="1. 安全加密" class="sidebar-link">1. 安全加密</a></li><li class="sidebar-sub-header"><a href="/books/pages/29a5b1/#_2-唯一标示" title="2. 唯一标示" class="sidebar-link">2. 唯一标示</a></li><li class="sidebar-sub-header"><a href="/books/pages/29a5b1/#_3-数据校验" title="3. 数据校验" class="sidebar-link">3. 数据校验</a></li><li class="sidebar-sub-header"><a href="/books/pages/29a5b1/#_4-散列函数" title="4. 散列函数" class="sidebar-link">4. 散列函数</a></li><li class="sidebar-sub-header"><a href="/books/pages/29a5b1/#_5-负载均衡" title="5. 负载均衡" class="sidebar-link">5. 负载均衡</a></li><li class="sidebar-sub-header"><a href="/books/pages/29a5b1/#_6-数据分片" title="6. 数据分片" class="sidebar-link">6. 数据分片</a></li><li class="sidebar-sub-header"><a href="/books/pages/29a5b1/#_7-分布式存储" title="7. 分布式存储" class="sidebar-link">7. 分布式存储</a></li><li class="sidebar-sub-header"><a href="/books/pages/29a5b1/#思考" title="思考" class="sidebar-link">思考</a></li></ul></li><li><a href="/books/pages/848326/" title="14-er-cha-shu" class="sidebar-link">14-er-cha-shu</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/848326/#_1-二叉树" title="1. 二叉树" class="sidebar-link">1. 二叉树</a></li><li class="sidebar-sub-header"><a href="/books/pages/848326/#_2-二叉查找树（binary-search-tree）" title="2. 二叉查找树（Binary Search Tree）" class="sidebar-link">2. 二叉查找树（Binary Search Tree）</a></li><li class="sidebar-sub-header"><a href="/books/pages/848326/#思考" title="思考" class="sidebar-link">思考</a></li></ul></li><li><a href="/books/pages/e58704/" title="15-hong-hei-shu" class="sidebar-link">15-hong-hei-shu</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/e58704/#_1-红黑树（r-b-tree）的定义" title="1. 红黑树（R-B Tree）的定义" class="sidebar-link">1. 红黑树（R-B Tree）的定义</a></li><li class="sidebar-sub-header"><a href="/books/pages/e58704/#_2-平衡性分析" title="2. 平衡性分析" class="sidebar-link">2. 平衡性分析</a></li><li class="sidebar-sub-header"><a href="/books/pages/e58704/#_3-红黑树的插入" title="3. 红黑树的插入" class="sidebar-link">3. 红黑树的插入</a></li><li class="sidebar-sub-header"><a href="/books/pages/e58704/#_4-红黑树的删除" title="4. 红黑树的删除" class="sidebar-link">4. 红黑树的删除</a></li><li class="sidebar-sub-header"><a href="/books/pages/e58704/#思考" title="思考" class="sidebar-link">思考</a></li></ul></li><li><a href="/books/pages/d7b69f/" title="16-di-gui-shu" class="sidebar-link">16-di-gui-shu</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/pages/d7b69f/#_1-递归树与时间复杂度分析" title="1. 递归树与时间复杂度分析" class="sidebar-link">1. 递归树与时间复杂度分析</a></li><li class="sidebar-sub-header"><a href="/books/pages/d7b69f/#_2-分析快速排序的时间复杂度" title="2. 分析快速排序的时间复杂度" class="sidebar-link">2. 分析快速排序的时间复杂度</a></li><li class="sidebar-sub-header"><a href="/books/pages/d7b69f/#_3-分析斐波那契数列的时间复杂度" title="3. 分析斐波那契数列的时间复杂度" class="sidebar-link">3. 分析斐波那契数列的时间复杂度</a></li><li class="sidebar-sub-header"><a href="/books/pages/d7b69f/#_4-分析全排列的时间复杂度" title="4. 分析全排列的时间复杂度" class="sidebar-link">4. 分析全排列的时间复杂度</a></li><li class="sidebar-sub-header"><a href="/books/pages/d7b69f/#_5-思考" title="5. 思考" class="sidebar-link">5. 思考</a></li></ul></li></ul></section></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="_05-队列"><a href="#_05-队列" class="header-anchor">#</a> 05 | 队列</h1> <p>与栈后进先出的特点相比较，队列也是<strong>一种操作受限的线性表</strong>，只有**入队（enqueue）<strong>和</strong>出队（dequeue）**两种操作，但其特点正好与栈相反，是先进先出（FIFO）的。</p> <ul><li><p>入队：放一个元素到队列尾部。</p></li> <li><p>出队：从队列头部取出一个元素。</p> <p><img src="https://static001.geekbang.org/resource/image/9e/3e/9eca53f9b557b1213c5d94b94e9dce3e.jpg" alt="队列和栈"></p></li></ul> <h2 id="_1-顺序队列和链式队列"><a href="#_1-顺序队列和链式队列" class="header-anchor">#</a> 1. 顺序队列和链式队列</h2> <p>跟栈类似，用数组实现的队列称为<strong>顺序队列</strong>，用链表实现的队列则成为<strong>链式队列</strong>。</p> <h3 id="_1-1-顺序队列"><a href="#_1-1-顺序队列" class="header-anchor">#</a> 1.1 顺序队列</h3> <p>接下来用Java代码实现一个队列：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 用数组实现的队列</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayQueue</span> <span class="token punctuation">{</span>
  <span class="token comment">// 数组：items，数组大小：n</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> items<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// head表示队头下标，tail表示队尾下标</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> head <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> tail <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token comment">// 申请一个大小为capacity的数组</span>
  <span class="token keyword">public</span> <span class="token class-name">ArrayQueue</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    items <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
    n <span class="token operator">=</span> capacity<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 入队</span>
  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token class-name">String</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果tail == n 表示队列已经满了</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tail <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    items<span class="token punctuation">[</span>tail<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>
    <span class="token operator">++</span>tail<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 出队</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">dequeue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果head == tail 表示队列为空</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">==</span> tail<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">// 为了让其他语言的同学看的更加明确，把--操作放到单独一行来写了</span>
    <span class="token class-name">String</span> ret <span class="token operator">=</span> items<span class="token punctuation">[</span>head<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">++</span>head<span class="token punctuation">;</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>对于栈来说，只需要一个<strong>栈顶指针</strong>即可，但对于队列来说，需要两个指针来指向队头head以及队尾tail。</p> <p>上述代码有个问题，就是在入队出队几次后，head和tail都会往后移动，当tail到了最右边，即使队列内还有空间，也无法继续添加元素了。</p> <p>为了解决这个问题，我们可以使用<strong>数据搬移</strong>，在入队的时候进行数据搬移，但数据搬移的时间复杂度为<mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="7.106ex" height="2.262ex" viewBox="0 -750 3141 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mtext" fill="red" stroke="red" transform="translate(763, 0)"><path data-c="5C" d="M56 731Q56 740 62 745T75 750Q85 750 92 740Q96 733 270 255T444 -231Q444 -239 438 -244T424 -250Q414 -250 407 -240Q404 -236 230 242T56 731Z"></path><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" transform="translate(500, 0)"></path></g><g data-mml-node="mi" transform="translate(1652, 0)"><path data-c="6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mtext" fill="red" stroke="red" transform="translate(2252, 0)"><path data-c="5C" d="M56 731Q56 740 62 745T75 750Q85 750 92 740Q96 733 270 255T444 -231Q444 -239 438 -244T424 -250Q414 -250 407 -240Q404 -236 230 242T56 731Z"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(500, 0)"></path></g></g></g></svg></mjx-container>，为了避免入队的时间复杂度提高，我们可以在tail到达数组最右边的时候，再集中一次进行数据搬移，这样时间复杂度就降为了<mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="6.88ex" height="2.262ex" viewBox="0 -750 3041 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mtext" fill="red" stroke="red" transform="translate(763, 0)"><path data-c="5C" d="M56 731Q56 740 62 745T75 750Q85 750 92 740Q96 733 270 255T444 -231Q444 -239 438 -244T424 -250Q414 -250 407 -240Q404 -236 230 242T56 731Z"></path><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" transform="translate(500, 0)"></path></g><g data-mml-node="mn" transform="translate(1652, 0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mtext" fill="red" stroke="red" transform="translate(2152, 0)"><path data-c="5C" d="M56 731Q56 740 62 745T75 750Q85 750 92 740Q96 733 270 255T444 -231Q444 -239 438 -244T424 -250Q414 -250 407 -240Q404 -236 230 242T56 731Z"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(500, 0)"></path></g></g></g></svg></mjx-container>。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>   <span class="token comment">// 入队操作，将item放入队尾</span>
  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token class-name">String</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// tail == n表示队列末尾没有空间了</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tail <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// tail ==n &amp;&amp; head==0，表示整个队列都占满了</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token comment">// 数据搬移</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> head<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tail<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        items<span class="token punctuation">[</span>i<span class="token operator">-</span>head<span class="token punctuation">]</span> <span class="token operator">=</span> items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 搬移完之后重新更新head和tail</span>
      tail <span class="token operator">-=</span> head<span class="token punctuation">;</span>
      head <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    items<span class="token punctuation">[</span>tail<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>
    <span class="token operator">++</span>tail<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_1-2-链式队列"><a href="#_1-2-链式队列" class="header-anchor">#</a> 1.2 链式队列</h3> <p>基于链表实现的队列，同样需要两个指针，一个指向队头head，一个指向队尾tail，入队的时，tail-&gt;next=new_node,tail=new_node，出队时，head=head-&gt;next，具体实现如下：</p> <div class="language-scala line-numbers-mode"><pre class="language-scala"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_2-循环队列"><a href="#_2-循环队列" class="header-anchor">#</a> 2. 循环队列</h2> <p>前面使用数组实现队列的时候，在tail==n时，会发生数据搬移，时间复杂度为<mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="7.106ex" height="2.262ex" viewBox="0 -750 3141 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mtext" fill="red" stroke="red" transform="translate(763, 0)"><path data-c="5C" d="M56 731Q56 740 62 745T75 750Q85 750 92 740Q96 733 270 255T444 -231Q444 -239 438 -244T424 -250Q414 -250 407 -240Q404 -236 230 242T56 731Z"></path><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" transform="translate(500, 0)"></path></g><g data-mml-node="mi" transform="translate(1652, 0)"><path data-c="6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mtext" fill="red" stroke="red" transform="translate(2252, 0)"><path data-c="5C" d="M56 731Q56 740 62 745T75 750Q85 750 92 740Q96 733 270 255T444 -231Q444 -239 438 -244T424 -250Q414 -250 407 -240Q404 -236 230 242T56 731Z"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(500, 0)"></path></g></g></g></svg></mjx-container>。为了避免这种情况，我们可以采用循环队列的方式解决这个问题。</p> <p>循环队列，其实就是将首尾相连，从而消除末端，如下图：</p> <p><img src="https://static001.geekbang.org/resource/image/58/90/58ba37bb4102b87d66dffe7148b0f990.jpg" alt="循环队列"></p> <p>从图中可以看到，这样无论我们怎么放入，都不需要做数据的迁移。</p> <p>写好循环队列代码有两个关键点：<strong>确定好队空和队满的判定条件</strong>。</p> <ul><li>队空：这个很好判断，就是队头head==队尾tail的时候，队列即为空</li> <li>队满：判断队满的条件略为复杂，我们需要通过求余的方式，将数组变为一个循环（从而模拟首尾相连），那么队满的时候也就是**(tail+1)%n=head**的时候。</li></ul> <p><img src="https://static001.geekbang.org/resource/image/3d/ec/3d81a44f8c42b3ceee55605f9aeedcec.jpg" alt="循环队列队满"></p> <p>从图中可以看到，循环队列会有一个元素位置的浪费，这里不能再添加元素，否则就会变为tail==head，与判断队空的条件重叠。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">ArrayQueue</span><span class="token punctuation">(</span>len<span class="token operator">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 数组：items，数组大小：n</span>
  val items<span class="token operator">:</span> <span class="token class-name">Array</span><span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span>
  <span class="token comment">// head表示队头下标，tail表示队尾下标</span>
  <span class="token keyword">var</span> head <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">var</span> tail <span class="token operator">=</span> <span class="token number">0</span>

  <span class="token comment">// 入队</span>
  def <span class="token function">enqueue</span><span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Boolean</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>tail <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> len <span class="token operator">==</span> head <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Queue is full...&quot;</span><span class="token punctuation">)</span>
      <span class="token boolean">false</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">items</span><span class="token punctuation">(</span>tail<span class="token punctuation">)</span> <span class="token operator">=</span> item
      tail <span class="token operator">=</span> <span class="token punctuation">(</span>tail <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> len
      <span class="token function">println</span><span class="token punctuation">(</span>s<span class="token string">&quot;Enqueue:$item&quot;</span><span class="token punctuation">)</span>
      <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 出队</span>
  def dequeue<span class="token operator">:</span> <span class="token class-name">Boolean</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>head <span class="token operator">==</span> tail<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Queue is null...&quot;</span><span class="token punctuation">)</span>
      <span class="token boolean">false</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">println</span><span class="token punctuation">(</span>s<span class="token string">&quot;Dequeue:${items(head)}&quot;</span><span class="token punctuation">)</span>
      <span class="token function">items</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
      head <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> len
      <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="_3-阻塞队列和并发队列"><a href="#_3-阻塞队列和并发队列" class="header-anchor">#</a> 3. 阻塞队列和并发队列</h2> <p>通常前面介绍到的队列并不常使用到，但是一旦增加了一些特性，应用却很广泛。如阻塞队列（典型代表：BlockingQueue），并发队列（典型代表：Disruptor）。</p> <p><strong>阻塞队列</strong>：在队列基础上增加了阻塞操作，在队列为空的时候，从队头取数据操作会被阻塞住，直到有数据进来才能执行并返回；在队列满的时候，从队尾塞数据的操作会被阻塞住，直到队列有空位才会执行并返回。</p> <p><img src="https://static001.geekbang.org/resource/image/5e/eb/5ef3326181907dea0964f612890185eb.jpg" alt="阻塞队列"></p> <p>从上面的描述来看，其实就是一个经典的“生产——消费”模型，我们可以通过阻塞队列轻松地实现一个“生产——消费者”模型。</p> <p>这种阻塞模型，可以有效地协调生产跟消费之间的速率，当生产速度过快，消费者又来不及消费的时候，队列会很快被填满从而阻塞生产者，避免对消费者产生冲击，在实际业务中可以到达削峰的作用。</p> <p>并且，基于阻塞队列，我们还可以控制生产者以及消费者之间的对应关系，通过增加消费者，形成一对多的模型，提高消费速率：</p> <p><img src="https://static001.geekbang.org/resource/image/9f/67/9f539cc0f1edc20e7fa6559193898067.jpg" alt="一对多"></p> <p>既然在阻塞队列上有多个消费者消费，那就涉及到了线程安全问题，而线程安全的队列我们又叫做<strong>并发队列</strong>。</p> <p>并发队列最直接的实现方式是直接在enqueue()、dequeue()上加锁，但是锁粒度较大，会导致并发度不够。实际上，基于数组的循环队列，可以利用CAS机制来实现非常高效的并发队列，这也是循环队列比链式队列应用更加光法的原因。</p> <p>Disruptor就是并发队列的一种极其高效的实现，后面会专门再有一篇文章来讲。</p> <h2 id="_4-思考"><a href="#_4-思考" class="header-anchor">#</a> 4. 思考</h2> <p><strong>Q</strong>：线程池没有空闲线程时，新的任务请求线程资源时，线程池该如何处理？各种处理策略又是如何实现的呢？</p> <blockquote><p>线程池在没有空闲线程时，新的任务请求要么直接拒绝，要么储存起来待有空闲线程再处理。若要存储起来，希望能够按照FIFO的方式来处理的话，那么队列是非常合适的。</p> <p>队列又分为基于数组实现以及链表实现。</p> <p>链表实现的队列，由于可以无限存储请求，因此其是一个无界队列（unbounded queue），当存储过多请求时，会占用大量系统资源，所以对于响应时间敏感的系统，链式队列是不太合适的。</p> <p>数组实现的队列，存储有限个请求，当队列也满了才拒绝请求，然而队列的大小设置也是需要各种实际测试的，太小了无法充分利用系统资源，发挥最大性能，太大又会占用大量系统资源。</p> <p>实际上，对于大部分资源有限的场景，当没有空闲资源的时候，基本都可以通过队列这种数据结构来实现请求排队。</p></blockquote> <p><strong>Q</strong>：并发队列，关于如何实现无锁并发队列？</p> <blockquote><p>可以在循环队列的基础上，利用CAS机制来实现，当入队时，对tail指针进行CAS，当tail发生变化时，代表已经有其他线程操作过了，于是重新获取tail执行操作。当出队时同理，只不过换成了对head指针进行CAS。</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/books/pages/33f199/" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        04-zhan
      </a></span> <span class="next"><a href="/books/pages/5a8205/">
        06-di-gui
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/books/assets/js/app.f9151f91.js" defer></script><script src="/books/assets/js/2.5d2686d5.js" defer></script><script src="/books/assets/js/56.5c06941f.js" defer></script>
  </body>
</html>