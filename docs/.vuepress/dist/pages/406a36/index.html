<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>07-li-lun-si-na-xie-dai-ma-she-ji-kan-si-shi-mian-xiang-dui-xiang-shi-ji-shi-mian-xiang-guo-cheng-de | zxk&#39;s book</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="/books/Avatar.jpg">
    <meta name="description" content="兴趣使然的备忘库">
    <link rel="preload" href="/books/assets/css/0.styles.2bff962d.css" as="style"><link rel="preload" href="/books/assets/js/app.f9151f91.js" as="script"><link rel="preload" href="/books/assets/js/2.5d2686d5.js" as="script"><link rel="preload" href="/books/assets/js/102.07dacb70.js" as="script"><link rel="prefetch" href="/books/assets/js/10.f2f9b742.js"><link rel="prefetch" href="/books/assets/js/100.6b9e14d2.js"><link rel="prefetch" href="/books/assets/js/101.809c333a.js"><link rel="prefetch" href="/books/assets/js/103.82a790ad.js"><link rel="prefetch" href="/books/assets/js/104.e0568e90.js"><link rel="prefetch" href="/books/assets/js/105.31bdf646.js"><link rel="prefetch" href="/books/assets/js/106.bdee5f25.js"><link rel="prefetch" href="/books/assets/js/107.18b4d846.js"><link rel="prefetch" href="/books/assets/js/108.c7f4b781.js"><link rel="prefetch" href="/books/assets/js/109.e162c870.js"><link rel="prefetch" href="/books/assets/js/11.eaeab904.js"><link rel="prefetch" href="/books/assets/js/110.12faedac.js"><link rel="prefetch" href="/books/assets/js/111.6511b4c1.js"><link rel="prefetch" href="/books/assets/js/112.904e9119.js"><link rel="prefetch" href="/books/assets/js/113.a472c3d2.js"><link rel="prefetch" href="/books/assets/js/12.fddb2c97.js"><link rel="prefetch" href="/books/assets/js/13.5bc2badc.js"><link rel="prefetch" href="/books/assets/js/14.b4364281.js"><link rel="prefetch" href="/books/assets/js/15.079b350f.js"><link rel="prefetch" href="/books/assets/js/16.32ceddec.js"><link rel="prefetch" href="/books/assets/js/17.ef4b2635.js"><link rel="prefetch" href="/books/assets/js/18.08f0107e.js"><link rel="prefetch" href="/books/assets/js/19.eaf9b482.js"><link rel="prefetch" href="/books/assets/js/20.1b9e5f90.js"><link rel="prefetch" href="/books/assets/js/21.26fba91c.js"><link rel="prefetch" href="/books/assets/js/22.ad47033d.js"><link rel="prefetch" href="/books/assets/js/23.b5c9bae3.js"><link rel="prefetch" href="/books/assets/js/24.a3413f8c.js"><link rel="prefetch" href="/books/assets/js/25.e83b9eb2.js"><link rel="prefetch" href="/books/assets/js/26.b57ca478.js"><link rel="prefetch" href="/books/assets/js/27.e5299aa1.js"><link rel="prefetch" href="/books/assets/js/28.a8237bd6.js"><link rel="prefetch" href="/books/assets/js/29.f864591a.js"><link rel="prefetch" href="/books/assets/js/3.3d5ed5b9.js"><link rel="prefetch" href="/books/assets/js/30.09c7f951.js"><link rel="prefetch" href="/books/assets/js/31.a3b1ad43.js"><link rel="prefetch" href="/books/assets/js/32.42bb8a78.js"><link rel="prefetch" href="/books/assets/js/33.55ba559d.js"><link rel="prefetch" href="/books/assets/js/34.84a76cd1.js"><link rel="prefetch" href="/books/assets/js/35.2eb759c6.js"><link rel="prefetch" href="/books/assets/js/36.d87c909a.js"><link rel="prefetch" href="/books/assets/js/37.676b1811.js"><link rel="prefetch" href="/books/assets/js/38.8f7d1a0c.js"><link rel="prefetch" href="/books/assets/js/39.a9c6f365.js"><link rel="prefetch" href="/books/assets/js/4.e8102eb5.js"><link rel="prefetch" href="/books/assets/js/40.dfc0be78.js"><link rel="prefetch" href="/books/assets/js/41.220cd735.js"><link rel="prefetch" href="/books/assets/js/42.d1d8b76d.js"><link rel="prefetch" href="/books/assets/js/43.c89fa3d4.js"><link rel="prefetch" href="/books/assets/js/44.4d0d2eac.js"><link rel="prefetch" href="/books/assets/js/45.217bc0d6.js"><link rel="prefetch" href="/books/assets/js/46.9e209fe4.js"><link rel="prefetch" href="/books/assets/js/47.6cafdd03.js"><link rel="prefetch" href="/books/assets/js/48.1ed1152d.js"><link rel="prefetch" href="/books/assets/js/49.1dfa167c.js"><link rel="prefetch" href="/books/assets/js/5.57058efb.js"><link rel="prefetch" href="/books/assets/js/50.67247263.js"><link rel="prefetch" href="/books/assets/js/51.f3f44eac.js"><link rel="prefetch" href="/books/assets/js/52.dee96030.js"><link rel="prefetch" href="/books/assets/js/53.8de5e5da.js"><link rel="prefetch" href="/books/assets/js/54.c29e9824.js"><link rel="prefetch" href="/books/assets/js/55.63e78072.js"><link rel="prefetch" href="/books/assets/js/56.5c06941f.js"><link rel="prefetch" href="/books/assets/js/57.b7a5455e.js"><link rel="prefetch" href="/books/assets/js/58.399bfd87.js"><link rel="prefetch" href="/books/assets/js/59.e8ba8726.js"><link rel="prefetch" href="/books/assets/js/6.c21fcf0a.js"><link rel="prefetch" href="/books/assets/js/60.02c5e9e4.js"><link rel="prefetch" href="/books/assets/js/61.d7a8dff4.js"><link rel="prefetch" href="/books/assets/js/62.9fbe6b12.js"><link rel="prefetch" href="/books/assets/js/63.f4144691.js"><link rel="prefetch" href="/books/assets/js/64.625a5997.js"><link rel="prefetch" href="/books/assets/js/65.f151fcc6.js"><link rel="prefetch" href="/books/assets/js/66.5dd49279.js"><link rel="prefetch" href="/books/assets/js/67.b261a8bb.js"><link rel="prefetch" href="/books/assets/js/68.5c0db65d.js"><link rel="prefetch" href="/books/assets/js/69.f29b8f9d.js"><link rel="prefetch" href="/books/assets/js/7.29e49b4b.js"><link rel="prefetch" href="/books/assets/js/70.209f4eea.js"><link rel="prefetch" href="/books/assets/js/71.22af6d4e.js"><link rel="prefetch" href="/books/assets/js/72.873c578d.js"><link rel="prefetch" href="/books/assets/js/73.582c4c19.js"><link rel="prefetch" href="/books/assets/js/74.2e9b50a7.js"><link rel="prefetch" href="/books/assets/js/75.cb1c78b7.js"><link rel="prefetch" href="/books/assets/js/76.571a1206.js"><link rel="prefetch" href="/books/assets/js/77.ae6dfb32.js"><link rel="prefetch" href="/books/assets/js/78.99676d8d.js"><link rel="prefetch" href="/books/assets/js/79.a69c427f.js"><link rel="prefetch" href="/books/assets/js/8.6baa7a2a.js"><link rel="prefetch" href="/books/assets/js/80.360e369a.js"><link rel="prefetch" href="/books/assets/js/81.a726b870.js"><link rel="prefetch" href="/books/assets/js/82.f8c4b75c.js"><link rel="prefetch" href="/books/assets/js/83.883eda30.js"><link rel="prefetch" href="/books/assets/js/84.12b612f0.js"><link rel="prefetch" href="/books/assets/js/85.7d06897a.js"><link rel="prefetch" href="/books/assets/js/86.fef0a5ab.js"><link rel="prefetch" href="/books/assets/js/87.81793334.js"><link rel="prefetch" href="/books/assets/js/88.c83371a7.js"><link rel="prefetch" href="/books/assets/js/89.ba300068.js"><link rel="prefetch" href="/books/assets/js/9.0a57bc79.js"><link rel="prefetch" href="/books/assets/js/90.28dd693b.js"><link rel="prefetch" href="/books/assets/js/91.b003bc4b.js"><link rel="prefetch" href="/books/assets/js/92.f5f082b1.js"><link rel="prefetch" href="/books/assets/js/93.64814564.js"><link rel="prefetch" href="/books/assets/js/94.711d6b38.js"><link rel="prefetch" href="/books/assets/js/95.84a10586.js"><link rel="prefetch" href="/books/assets/js/96.28278f73.js"><link rel="prefetch" href="/books/assets/js/97.a67549d9.js"><link rel="prefetch" href="/books/assets/js/98.11356857.js"><link rel="prefetch" href="/books/assets/js/99.c056a3dc.js">
    <link rel="stylesheet" href="/books/assets/css/0.styles.2bff962d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/books/" class="router-link-active home-link"><img src="/books/Avatar.jpg" alt="zxk's book" class="logo"> <span class="site-name">zxk's book</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          大数据
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/books/" class="router-link-active">
          Home
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <a href="https://github.com/Rianico/books" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>02.设计模式之美（专栏学习）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/books/设计模式/02.设计模式之美（专栏学习）/02.02  从哪些维度评判代码质量的好坏？如何具备写出高质量代码的能力？.html" title="02 | 从哪些维度评判代码质量的好坏？如何具备写出高质量代码的能力？" class="sidebar-link">02 | 从哪些维度评判代码质量的好坏？如何具备写出高质量代码的能力？</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/books/pages/d1e446/" title="03-mian-xiang-dui-xiang-she-ji-yuan-ze-she-ji-mo-shi-bian-cheng-gui-fan-zhong-gou-zhe-wu-zhe-you-he" class="sidebar-link">03-mian-xiang-dui-xiang-she-ji-yuan-ze-she-ji-mo-shi-bian-cheng-gui-fan-zhong-gou-zhe-wu-zhe-you-he</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/books/pages/c85a14/" title="04-li-lun-yi-dang-tan-lun-mian-xiang-dui-xiang-de-shi-hou-wo-men-dao-di-zai-tan-lun-shen-me" class="sidebar-link">04-li-lun-yi-dang-tan-lun-mian-xiang-dui-xiang-de-shi-hou-wo-men-dao-di-zai-tan-lun-shen-me</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/books/pages/9f77f2/" title="05-li-lun-er-feng-zhuang-chou-xiang-ji-cheng-duo-tai-fen-bie-ke-yi-jie-jue-na-xie-bian-cheng-wen-ti" class="sidebar-link">05-li-lun-er-feng-zhuang-chou-xiang-ji-cheng-duo-tai-fen-bie-ke-yi-jie-jue-na-xie-bian-cheng-wen-ti</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/books/pages/9ff045/" title="06-li-lun-san-mian-xiang-dui-xiang-xiang-bi-mian-xiang-guo-cheng-you-na-xie-you-shi-mian-xiang-guo-c" class="sidebar-link">06-li-lun-san-mian-xiang-dui-xiang-xiang-bi-mian-xiang-guo-cheng-you-na-xie-you-shi-mian-xiang-guo-c</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/books/pages/406a36/" aria-current="page" title="07-li-lun-si-na-xie-dai-ma-she-ji-kan-si-shi-mian-xiang-dui-xiang-shi-ji-shi-mian-xiang-guo-cheng-de" class="active sidebar-link">07-li-lun-si-na-xie-dai-ma-she-ji-kan-si-shi-mian-xiang-dui-xiang-shi-ji-shi-mian-xiang-guo-cheng-de</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/books/pages/d7e9c1/" title="08-li-lun-wu-jie-kou-vs-chou-xiang-lei-de-qu-bie-ru-he-yong-pu-tong-de-lei-mo-ni-chou-xiang-lei-he-j" class="sidebar-link">08-li-lun-wu-jie-kou-vs-chou-xiang-lei-de-qu-bie-ru-he-yong-pu-tong-de-lei-mo-ni-chou-xiang-lei-he-j</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/books/pages/d28799/" title="09-li-lun-liu-wei-shen-me-ji-yu-jie-kou-er-fei-shi-xian-bian-cheng-you-bi-yao-wei-mei-ge-lei-du-ding" class="sidebar-link">09-li-lun-liu-wei-shen-me-ji-yu-jie-kou-er-fei-shi-xian-bian-cheng-you-bi-yao-wei-mei-ge-lei-du-ding</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/books/pages/12f1f3/" title="README" class="sidebar-link">README</a></li></ul></section></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="_07-理论四：哪些代码设计看似是面向对象，实际是面向过程的"><a href="#_07-理论四：哪些代码设计看似是面向对象，实际是面向过程的" class="header-anchor">#</a> 07 | 理论四：哪些代码设计看似是面向对象，实际是面向过程的</h1> <h3 id="哪些代码设计看似是面向对象，实际是面向过程的？"><a href="#哪些代码设计看似是面向对象，实际是面向过程的？" class="header-anchor">#</a> 哪些代码设计看似是面向对象，实际是面向过程的？</h3> <p>在用面向对象编程语言进行软件开发的时候，我们有时候会写出面向过程风格的代码。有些是有意为之，并无不妥；而有些是无意为之，会影响到代码的质量。</p> <h4 id="_1-滥用getter、setter"><a href="#_1-滥用getter、setter" class="header-anchor">#</a> 1. 滥用getter、setter</h4> <p>通常来说，为一个类的所有属性都设定getter、setter方法，往往会破坏面向对象的封装原则（ 通过访问权限控制，隐藏内部数据，外部仅能通过类提供的有限的接口访问、修改内部数据 ），使其退化为面向过程编程，以下面一个模拟购物车的代码为例：</p> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code> public class ShoppingCart <span class="token punctuation">{</span>
   private int itemsCount<span class="token punctuation">;</span>
   private double totalPrice<span class="token punctuation">;</span>
   private List<span class="token operator">&lt;</span>ShoppingCartItem<span class="token operator">&gt;</span> items <span class="token operator">=</span> <span class="token keyword">new</span> ArrayList<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   public int <span class="token function">getItemsCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> this<span class="token operator">.</span>itemsCount<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   public void <span class="token function">setItemsCount</span><span class="token punctuation">(</span>int itemsCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     this<span class="token operator">.</span>itemsCount <span class="token operator">=</span> itemsCount<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   public double <span class="token function">getTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> this<span class="token operator">.</span>totalPrice<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   public void <span class="token function">setTotalPrice</span><span class="token punctuation">(</span>double totalPrice<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     this<span class="token operator">.</span>totalPrice <span class="token operator">=</span> totalPrice<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
 ​
   public List<span class="token operator">&lt;</span>ShoppingCartItem<span class="token operator">&gt;</span> <span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> this<span class="token operator">.</span>items<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   public void <span class="token function">addItem</span><span class="token punctuation">(</span>ShoppingCartItem item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     items<span class="token operator">.</span><span class="token function">add</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
     itemsCount<span class="token operator">+</span><span class="token operator">+</span><span class="token punctuation">;</span>
     totalPrice <span class="token operator">+=</span> item<span class="token operator">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>省略其他方法<span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>首先看前两个属性 itemsCount 和 totalPrice ，它们都是定义了private作用域，然而我们又定义了public作用域的getter、setter，使得外部可以随意访问、设置这两个属性。</p> <p>再看下items属性，为itemsCount 和 totalPrice的getter设置getter也无伤大雅，毕竟不会改变属性值，但是对于items来说就不一样了，因为item本身是一个可变集合（mutable collection）， 外部调用者在拿到这个容器之后，是可以操作容器内部数据的 ，比如：</p> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code> ShoppingCart cart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ShoppCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>
 cart<span class="token operator">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> 清空购物车
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如此一来，如果外部调用者清空了购物车（item），则会导致 itemsCount 和 totalPrice状态的不一致，因此，正确的做法是，将清空购物车的逻辑封装起来，透明地给调用者使用：</p> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code> public class ShoppingCart <span class="token punctuation">{</span>
   <span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>省略其他代码<span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>
   public void <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     items<span class="token operator">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     itemsCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
     totalPrice <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>可能还会有个需求，说是需要浏览购物车的信息，那么就不得不暴露 items 的信息了，那么如何防止item内部状态被破坏？</p> <p>在Java语言中，我们可以利用 <code>Collections.unmodifiableList()</code> 做一层包装，使其返回一个不可变的集合（immutable collection），这个容器类重写了 List 容器中跟修改数据相关的方法，比如 add()、clear() 等方法。一旦我们调用这些修改数据的方法，代码就会抛出 UnsupportedOperationException 异常，这样就避免了容器中的数据被修改。 具体实现如下：</p> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code> public class ShoppingCart <span class="token punctuation">{</span>
   <span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>省略其他代码<span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>
   public List<span class="token operator">&lt;</span>ShoppingCartItem<span class="token operator">&gt;</span> <span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> Collections<span class="token operator">.</span><span class="token function">unmodifiableList</span><span class="token punctuation">(</span>this<span class="token operator">.</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 ​
 public class UnmodifiableList<span class="token operator">&lt;</span>E<span class="token operator">&gt;</span> extends UnmodifiableCollection<span class="token operator">&lt;</span>E<span class="token operator">&gt;</span>
                           implements List<span class="token operator">&lt;</span>E<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
   public boolean <span class="token function">add</span><span class="token punctuation">(</span>E <span class="token keyword">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token function">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   public void <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token function">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>省略其他代码<span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>
 <span class="token punctuation">}</span>
 ​
 ShoppingCart cart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ShoppingCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 List<span class="token operator">&lt;</span>ShoppingCartItem<span class="token operator">&gt;</span> items <span class="token operator">=</span> cart<span class="token operator">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 items<span class="token operator">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">/</span>抛出UnsupportedOperationException异常
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>即使这样实现后，代码还是会有问题，即使item不可变了，但item里的每个对象仍然是可以被外部破坏的：</p> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code> ShoppingCart cart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ShoppingCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 cart<span class="token operator">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">ShoppingCartItem</span><span class="token punctuation">(</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 List<span class="token operator">&lt;</span>ShoppingCartItem<span class="token operator">&gt;</span> items <span class="token operator">=</span> cart<span class="token operator">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 ShoppingCartItem item <span class="token operator">=</span> items<span class="token operator">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 item<span class="token operator">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token number">19.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> 这里修改了item的价格属性
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这里先不提如何解决，解决方案会在后面的设计模式再讲到。</p> <h4 id="_2-滥用全局变量和全局方法"><a href="#_2-滥用全局变量和全局方法" class="header-anchor">#</a> 2. 滥用全局变量和全局方法</h4> <p>在面向对象编程中，常见的全局变量有单例类对象、静态成员变量、常量等，常见的全局方法有静态方法。</p> <ul><li>单例类对象 ： 在全局代码中只有一份，相当于一个全局变量 ；</li> <li>静态成员变量：归属于类上的数据，被所有的实例化对象所共享，也相当于一定程度上的全局变量；</li> <li>常量：非常常见的全局变量，比如一些代码中的配置参数，一般都设置为常量，放到一个 Constants 类中；</li> <li>静态方法：一般用来操作静态变量或者外部数据，将数据跟方法分离，是一种典型的的面向过程编程。</li></ul> <p>在全局变量和全局方法中，<strong>Constants</strong> 类和 <strong>Utils</strong> 类最常用到，而且也是我们日常开发中经常使用到的类（如前面的<code>Collections</code>）， 接下来深入探讨一下全局变量和全局方法的利与弊。</p> <p><strong>Constants类</strong></p> <p>我们常见的一种Constants类如下：</p> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code> public class Constants <span class="token punctuation">{</span>
   public static final String MYSQL_ADDR_KEY <span class="token operator">=</span> <span class="token string">&quot;mysql_addr&quot;</span><span class="token punctuation">;</span>
   public static final String MYSQL_DB_NAME_KEY <span class="token operator">=</span> <span class="token string">&quot;db_name&quot;</span><span class="token punctuation">;</span>
   public static final String MYSQL_USERNAME_KEY <span class="token operator">=</span> <span class="token string">&quot;mysql_username&quot;</span><span class="token punctuation">;</span>
   public static final String MYSQL_PASSWORD_KEY <span class="token operator">=</span> <span class="token string">&quot;mysql_password&quot;</span><span class="token punctuation">;</span>

   public static final String REDIS_DEFAULT_ADDR <span class="token operator">=</span> <span class="token string">&quot;192.168.7.2:7234&quot;</span><span class="token punctuation">;</span>
   public static final int REDIS_DEFAULT_MAX_TOTAL <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
   public static final int REDIS_DEFAULT_MAX_IDLE <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
   public static final int REDIS_DEFAULT_MIN_IDLE <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
   public static final String REDIS_DEFAULT_KEY_PREFIX <span class="token operator">=</span> <span class="token string">&quot;rt:&quot;</span><span class="token punctuation">;</span>

   <span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>省略更多的常量定义<span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>这段代码中，我们把所有用到的常量都放到了一个类中，这样做有以下几点不好的地方：</p> <ol><li><strong>这中大而全的设计会影响代码的可维护性</strong>，如果参加项目的工程师很多，每个人都往里面添加常量，那么会使这个类一直增长，查找修改某个常量也会变得困难，以及增大代码提交的冲突。</li> <li><strong>增加代码的编译时间</strong>，当Constants类包含很多常量时，每次修改都会导致依赖这个类的代码需要重新编译，因此会浪费很多不必要的编译时间。</li> <li><strong>影响代码的复用性</strong>，如果在新的项目中需要复用某个类，而那个类又依赖Constants类，那么就会同时引入很多无关的变量。</li></ol> <p>改进Constants类有两种参考思路：</p> <ol><li>将Constants拆分为多个单一功能的类，比如Mysql相关的就放在MysqlConstants里，Redis的则放在RedisConstants中。</li> <li>直接定义在需要使用的类中，比如MysqlConfig用到了一个常量，那么就定义在MysqlConfig中，这样也提高了类设计的内聚性和复用性。个人认为，这种方式下，在Java中如果其他类需要用到该属性，去new一个类再调用常量就显得怪怪的，而Scala的伴生类在这一点则做得不错。</li></ol> <p><strong>Utils类</strong></p> <p>实际上，Utils 类的出现是基于这样一个问题背景：如果我们有两个类 A 和 B，它们要用到一块相同的功能逻辑，为了避免代码重复，我们不应该在两个类中，将这个相同的功能逻辑，重复地实现两遍。这个时候我们该怎么办呢？</p> <p>有时候， 有的时候，从业务含义上，A 类和 B 类并不一定具有继承关系，比如 Crawler 类和 PageAnalyzer 类，它们都用到了 URL 拼接和分割的功能，但并不具有继承关系（<strong>既不是父子关系，也不是兄弟关</strong>系）。这时候仅仅为了代码复用抽象出一个父类就不是很合适了。</p> <p>这时候既然继承不能解决问题，那么我们可以定义一个新的类，实现 URL 拼接和分割的方法。而拼接和分割两个方法，不需要共享任何数据，所以新的类不需要定义任何属性，这个时候，我们就可以把它定义为只包含静态方法的 Utils 类了。</p> <p>实际上，只包含静态方法不包含任何属性的 Utils 类，是彻彻底底的面向过程的编程风格，但并不是说面向对象编程中就要杜绝面向过程编程。面向过程编程（以方法为基本组织单位）能帮助我们解决代码复用问题，但也不能滥用。</p> <p>通前面的Constants一样，在定义Utils类的时候，最好也能细化一下，针对不同的功能，设计不同的 Utils 类，比如 FileUtils、IOUtils、StringUtils、UrlUtils 等，不要设计一个过于大而全的 Utils 类。</p> <h4 id="_3-定义数据和方法分离的类（贫血模型）"><a href="#_3-定义数据和方法分离的类（贫血模型）" class="header-anchor">#</a> 3. 定义数据和方法分离的类（贫血模型）</h4> <p>最后还有一种面向对象编程过程中，常见的面向过程风格的代码。那就是，数据定义在一个类中，方法定义在另一个类中。</p> <p>这种风格在基于 MVC 三层结构做 Web 方面的后端开发中经常能见到。</p> <p>传统的 MVC 结构分为 Model 层、Controller 层、View 层这三层。不过，在做前后端分离之后，三层结构在后端开发中，会稍微有些调整，被分为 Controller 层、Service 层、Repository 层。Controller 层负责暴露接口给前端调用，Service 层负责核心业务逻辑，Repository 层负责数据读写。而在每一层中，我们又会定义相应的 VO（View Object）、BO（Business Object）、Entity。 一般情况下，VO、BO、Entity 中只会定义数据，不会定义方法，所有操作这些数据的业务逻辑都定义在对应的 Controller 类、Service 类、Repository 类中。这就是典型的面向过程的编程风格。</p> <p>实际上，这种开发模式叫作基于贫血模型的开发模式，也是我们现在非常常用的一种 Web 项目的开发模式。 这种风格跟我们平时的项目开发结合得非常紧密，所以，更加细致、全面的讲解，会在面向对象实战环节里再讲透彻。</p> <h3 id="思考"><a href="#思考" class="header-anchor">#</a> 思考</h3> <h4 id="_1-在面向对象编程中，为什么容易写出面向过程风格的代码？"><a href="#_1-在面向对象编程中，为什么容易写出面向过程风格的代码？" class="header-anchor">#</a> 1. 在面向对象编程中，为什么容易写出面向过程风格的代码？</h4> <p>我们在进行面向对象编程的时候，总是很容易不由自主地写出面向过程编程，这是为什们呢？</p> <p>可以联想一下，在生活中，你去完成一个任务，你一般都会思考，应该先做什么、后做什么，如何一步一步地顺序执行一系列操作，最后完成整个任务。面向过程编程风格恰恰符合人的这种流程化思维方式。</p> <p>面向对象编程风格正好相反。它是一种<strong>自底向上的思考方式</strong>。它不是先去按照执行流程来分解任务，而是<strong>先将任务翻译成一个一个的小的模块（也就是类），设计类之间的交互，最后按照流程将类组装起来</strong>，完成整个任务， 这样的思考路径比较适合复杂程序的开发，但并不是特别符合人类的思考习惯。</p> <p>除此之外，面向对象编程要比面向过程编程难一些。在面向对象编程中，类的设计还是挺需要技巧，挺需要一定设计经验的。你要去思考如何封装合适的数据和方法到一个类里，如何设计类之间的关系，如何设计类之间的交互等等诸多设计问题。</p> <h4 id="_2-面向过程编程及面向过程编程语言就真的无用武之地了吗？"><a href="#_2-面向过程编程及面向过程编程语言就真的无用武之地了吗？" class="header-anchor">#</a> 2. 面向过程编程及面向过程编程语言就真的无用武之地了吗？</h4> <p>如果我们开发的是微小程序，或者是一个数据处理相关的代码，以算法为主，数据为辅，那脚本式的面向过程的编程风格就更适合一些。</p> <p>实际上，<strong>面向过程编程是面向对象编程的基础，面向对象编程离不开基础的面向过程编程</strong>。类中每个方法的实现逻辑，实际上就是面向过程编程的代码。</p> <p>不管使用面向过程还是面向对象哪种风格来写代码，我们最终的目的还是写出易维护、易读、易复用、易扩展的高质量代码。 只要我们能避免面向过程编程风格的一些弊端，控制好它的副作用，在掌控范围内为我们所用，我们就大可不用避讳在面向对象编程中写面向过程风格的代码。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/books/pages/9ff045/" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        06-li-lun-san-mian-xiang-dui-xiang-xiang-bi-mian-xiang-guo-cheng-you-na-xie-you-shi-mian-xiang-guo-c
      </a></span> <span class="next"><a href="/books/pages/d7e9c1/">
        08-li-lun-wu-jie-kou-vs-chou-xiang-lei-de-qu-bie-ru-he-yong-pu-tong-de-lei-mo-ni-chou-xiang-lei-he-j
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/books/assets/js/app.f9151f91.js" defer></script><script src="/books/assets/js/2.5d2686d5.js" defer></script><script src="/books/assets/js/102.07dacb70.js" defer></script>
  </body>
</html>