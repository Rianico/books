(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{739:function(e,t,s){"use strict";s.r(t);var r=s(70),o=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"cdh-集群修改-ip-為私網-ip"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cdh-集群修改-ip-為私網-ip"}},[e._v("#")]),e._v(" cdh 集群修改 IP 為私網 IP")]),e._v(" "),s("p",[e._v("最近因为网络改造，需要将集群节点内部通讯方式改为私网通讯，因此需要对集群配置做出更改，过程如下：")]),e._v(" "),s("ol",[s("li",[s("p",[e._v("cm 界面上所有服务都勾选 "),s("strong",[e._v("通配符")]),e._v(" 选项，开启多网卡监听。如果外部 client 仍需通过公网通信，还需设置 "),s("code",[e._v("dfs.client.use.datanode.hostname")]),e._v(" 为 true 以使用 hostname 而非私网 IP 通信。（详见"),s("a",{attrs:{href:"https://hadoop.apache.org/docs/r2.6.0/hadoop-project-dist/hadoop-hdfs/HdfsMultihoming.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("HDFS Support for Multihomed Networks"),s("OutboundLink")],1),e._v(")")])]),e._v(" "),s("li",[s("p",[e._v("暂停所有节点上的 "),s("code",[e._v("cloudera-scm-agent")]),e._v(" 服务，暂停cm主节点的 "),s("code",[e._v("cloudera-scm-server")]),e._v(" 服务。")])]),e._v(" "),s("li",[s("p",[e._v("批量修改所有节点上的 "),s("code",[e._v("/etc/cloudera-scm-agent/config.ini")]),e._v(" 配置，将 "),s("code",[e._v("server_host")]),e._v(" 为cm主节点的 IP 或者 hostname（推荐）：")]),e._v(" "),s("div",{staticClass:"language-vim line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-vim"}},[s("code",[e._v(" server_host"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("cm"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(".")]),e._v("stidc"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(".")]),e._v("gdyd\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("分发私网 IP 的hosts 到各节点下，记得先备份。")])]),e._v(" "),s("li",[s("p",[e._v("重启直接点上的 "),s("code",[e._v("cloudera-scm-server-db")]),e._v("服务。")])]),e._v(" "),s("li",[s("p",[e._v("启动 "),s("code",[e._v("cloudera-scm-server")]),e._v(" 以及 "),s("code",[e._v("cloudera-scm-agent")]),e._v(" 服务。")])]),e._v(" "),s("li",[s("p",[e._v("重启集群。")])]),e._v(" "),s("li",[s("p",[e._v("cm 上查看服务器，可以发现 IP 属性已变为私网 IP。")])])])])}),[],!1,null,null,null);t.default=o.exports}}]);