---
title: Scala 中的 Left 与 Right
date: 2020-05-26 17:06:05
---
# Scala 中的 Left 与 Right

Scala中的Either代表两个可能的值中的其中一个，有`Left`跟`Right`组成。除了作为二选一之外，通常也可作为异常值的处理，约定Left代表异常值，Right代表正常输出（与Try等价，也是代表异常的一种）。

Left，Right可以用match匹配（跟Option类似）：

```scala
val in = Console.readLine("Type Either a string or an Int: ")

val result: Either[String,Int] = try {
    Right(in.toInt)
  } catch {
    case e: Exception =>
      Left(in)
}

println( result match {
  case Right(x) => "You passed me the Int: " + x + ", which I will increment. " + x + " + 1 = " + (x+1)
  case Left(x) => "You passed me the String: " + x
})
```

Either还提供了投影（projection）操作，可单独对**任意一边**进行操作，也可改变类型，但是**最终结果仍为原本有值的那边**。

```scala
val l: Either[String, Int] = Left("flower")
l.left.map(_.size): Either[Int, Int] // Left(6)
l.right.map(_.toDouble): Either[String, Double] // Left("flower")
```

* fold：对两边同时进行操作。
* swap：对两边的内容进行交换。
* merge：合并两边的结果，通常为Any。

与`Try[A <: Exception, B]` 可相互进行转化：

```scala
import scala.util.{ Either, Failure, Left, Right, Success, Try }
implicit def eitherToTry[A <: Exception, B](either: Either[A, B]): Try[B] = {
  either match {
    case Right(obj) => Success(obj)
    case Left(err) => Failure(err)
  }
}
implicit def tryToEither[A](obj: Try[A]): Either[Throwable, A] = {
  obj match {
    case Success(something) => Right(something)
    case Failure(err) => Left(err)
  }
```

