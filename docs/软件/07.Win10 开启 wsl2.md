---
title: 07.Win10 开启 wsl2
date: 2021-05-23
---

## 07.Win10 开启 wsl2

1. 在 power-shell 中启用 Linux

   ```shell
   Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
   ```

2. 启用“虚拟机平台”可选功能，并设置子系统目录

   ```shell
   dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
   Set-Location D:\development
   Invoke-WebRequest -Uri https://aka.ms/wslubuntu2004 -OutFile Ubuntu.appx -UseBasicParsing
   Rename-Item .\Ubuntu.appx Ubuntu.zip
   Expand-Archive .\Ubuntu.zip -Verbose
   Set-Location D:\development\Ubuntu
   .\ubuntu2004.exe
   ```

3. 安装 wsl2 升级内核：https://docs.microsoft.com/zh-cn/windows/wsl/wsl2-kernel

4. 查看 distribution name：`wsl --list --verbose`

5. 设置 distribution name 默认版本为 2：

   ```shell
   wsl --set-version Ubuntu-20.04 2
   wsl --set-default-version 2
   ```

6. 更换镜像源：

   ```shell
   sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak
   sudo echo "deb http://mirrors.aliyun.com/ubuntu/ focal main restricted
   deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted
   deb http://mirrors.aliyun.com/ubuntu/ focal universe
   deb http://mirrors.aliyun.com/ubuntu/ focal-updates universe
   deb http://mirrors.aliyun.com/ubuntu/ focal multiverse
   deb http://mirrors.aliyun.com/ubuntu/ focal-updates multiverse
   deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse
   deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted
   deb http://mirrors.aliyun.com/ubuntu/ focal-security universe
   deb http://mirrors.aliyun.com/ubuntu/ focal-security multiverse" > /etc/apt/sources.list
   ```
